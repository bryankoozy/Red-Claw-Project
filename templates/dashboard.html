{% extends "base.html" %}

{% block title %}Dashboard - Red Claw{% endblock %}

{% block content %}

<div class="dashboard-page">

    <div class="dashboard-container">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Dashboard</h1>
            <div class="year-selector">
                <a href="{{ url_for('dashboard', year=selected_year - 1) }}" class="btn-year">← Previous</a>
                <span class="year-label">Year: {{ selected_year }}</span>
                <a href="{{ url_for('dashboard', year=selected_year + 1) }}" class="btn-year">Next →</a>
            </div>
        </div>


        <div class="main-content">
            <!-- Left: Monthly Sign Ups Chart -->
            <div class="chart-section">
                <h2 class="chart-title">Monthly Sign Ups ({{ selected_year }})</h2>
                <div class="chart-canvas">
                    <canvas id="signupLineChart"></canvas>
                </div>
            </div>

            <!-- Right: Total Sign Ups -->
            <div class="chart-section">
                <h2 class="chart-title">Total Sign Ups ({{ selected_year }})</h2>
                <div style="display: flex; align-items: center; justify-content: center; height: 300px;">
                    <div style="text-align: center;">
                        <div id="totalSignups" style="font-size: 8rem; font-weight: 700; color: #007bff; margin-bottom: 10px;">-</div>
                        <div style="font-size: 2rem; color: #6c757d;">Users Registered</div>
                    </div>
                </div>
            </div>

        </div>
        



        <!-- PACT Score Bars Section -->
        <div class="scores-section">
            <h2 class="chart-title">PACT Score Levels (Max: 68)</h2>
            <div class="score-bars">
                <div class="score-bar">
                    <div class="score-label">High (50+)</div>
                    <div class="bar-container">
                        <div class="bar-fill high-bar" id="pactHighBar">0</div>
                    </div>
                    <div class="score-count" id="pactHighCount">0</div>
                </div>
                
                <div class="score-bar">
                    <div class="score-label">Medium (30-49)</div>
                    <div class="bar-container">
                        <div class="bar-fill medium-bar" id="pactMediumBar">0</div>
                    </div>
                    <div class="score-count" id="pactMediumCount">0</div>
                </div>
                
                <div class="score-bar">
                    <div class="score-label">Low (<30)</div>
                    <div class="bar-container">
                        <div class="bar-fill low-bar" id="pactLowBar">0</div>
                    </div>
                    <div class="score-count" id="pactLowCount">0</div>
                </div>

                <div class="score-bar">
                    <div class="score-label">No Score Yet</div>
                    <div class="bar-container">
                        <div class="bar-fill no-score-bar" id="pactNoScoreBar">0</div>
                    </div>
                    <div class="score-count" id="pactNoScoreCount">0</div>
                </div>
            </div>
        </div>




        <div style="height: 2rem;"></div>



        <!-- Quiz Score Bars Section -->
        <div class="scores-section">
            <h2 class="chart-title">Quiz Score Levels (Max: 20)</h2>
            <div class="score-bars">
                <div class="score-bar">
                    <div class="score-label">High (15+)</div>
                    <div class="bar-container">
                        <div class="bar-fill high-bar" id="quizHighBar">0</div>
                    </div>
                    <div class="score-count" id="quizHighCount">0</div>
                </div>
                
                <div class="score-bar">
                    <div class="score-label">Medium (10-14)</div>
                    <div class="bar-container">
                        <div class="bar-fill medium-bar" id="quizMediumBar">0</div>
                    </div>
                    <div class="score-count" id="quizMediumCount">0</div>
                </div>
                
                <div class="score-bar">
                    <div class="score-label">Low (<10)</div>
                    <div class="bar-container">
                        <div class="bar-fill low-bar" id="quizLowBar">0</div>
                    </div>
                    <div class="score-count" id="quizLowCount">0</div>
                </div>

                <div class="score-bar">
                    <div class="score-label">No Score Yet</div>
                    <div class="bar-container">
                        <div class="bar-fill no-score-bar" id="quizNoScoreBar">0</div>
                    </div>
                    <div class="score-count" id="quizNoScoreCount">0</div>
                </div>
            </div>
        </div>

        <!-- View Details Button -->
        <div style="display: flex; gap: 10px;">
            <a href="{{ url_for('userDetail') }}" class="view-details-btn">View User Details</a>
            <a href="{{ url_for('appointments') }}" class="view-details-btn">View Appointment Details</a>
        </div>


    </div>



    <!-- Embed chart data as JSON for JS to read -->
    <script id="chart-data" type="application/json">
        {
        "months": {{ months | tojson }},
        "signups": {{ signups | tojson }},
        "pact_score_counts": {{ pact_score_counts | tojson }},
        "quiz_score_counts": {{ quiz_score_counts | tojson }}
        }
    </script>

</div>
{% endblock %}
